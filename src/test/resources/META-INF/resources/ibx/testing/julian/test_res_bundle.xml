<?xml version="1.0" encoding="UTF-8"?>
<ibx-res-bundle name="test_res_bundle.xml" loadContext="bundle">
	<strings>
		<string-file src="./test_res_strings.txt" default="false"/>
		<string-bundle>
			<![CDATA[
			{
				"language":"ibx_default",
				"strings":
				{
				}
			}
		]]>
		</string-bundle>
	</strings>

	<styles>
		<style-file src="./test_res_styles.css"/>
		<style-sheet>
		<![CDATA[
			.ibx-prop-heading
			{
				width:100%;
				box-sizing:border-box;
				overflow:hidden;
			}
			.ibx-prop-heading-label
			{
				padding:3px;
				background-color:#ccc;
				border:1px outset;
			}
			.ibx-prop-heading-name
			{
				width:25%;
			}
			.ibx-prop-heading-value
			{
				flex:1 1 auto;
			}
			.ibx-prop-tree
			{
				align-self:flex-start;
				width:25%;
				border-right:1px solid #ccc;
			}
			.ibx-prop-tree-node .tnode-label
			{
				border-bottom:1px solid #ccc;
			}
			.ibx-prop-values
			{
				flex:1 1 auto;
				xborder:1px solid lime;
			}
			.ibx-prop-splitter
			{
				min-width:1px;
				width:2px;
				background-color:#ccc;
				border:none;
			}
		]]>
		</style-sheet>
	</styles>

	<markup>
		<markup-file src="./test_res_markup.xml"/>
		<markup-block>
		</markup-block>
	</markup>

	<scripts>
		<script-file src="./test_res_script.js"/>
		<script-file src="../../ibxtools/shared_resources/js/ibfs.js" loadContext="ibx"/>
		<script-block>
		<![CDATA[
			var testProps = 
			{
				"border":
				{
					"displayName":"Border",
					"displayValue":"1px solid black",
					"value":"1px solid black",
					"type":"string",
					"uiType":"borderSelector",
					"props":
					{
						"left":
						{
							"displayName":"Left",
							"displayValue":"1px solid black",
							"value":"1px solid black",
							"type":"string",
							"uiType":"borderSelector",
							"props":
							{
								"width":
								{
									"displayName":"Width",
									"displayValue":"1px",
									"value":"1px",
									"type":"string",
									"uiType":"textField",
								},
								"style":
								{
									"displayName":"Style",
									"displayValue":"1px",
									"value":"1px",
									"type":"string",
									"uiType":"select",
									"values":
									{
										"solid":
										{
											"displayName":"Solid",
											"value":"solid",
										},
										"dashed":
										{
											"displayName":"Dashed",
											"value":"dashed",
										},
										"dotted":
										{
											"displayName":"Dotted",
											"value":"dotted",
										},
									},
								},
								"color":
								{
									"displayName":"Color",
									"displayValue":"red",
									"value":"red",
									"type":"color",
									"uiType":"colorPicker",
								},
							}
						}
					}
				}
			};

			$.widget("ibi.ibxPropertySheet", $.ibi.ibxHBox, 
			{
				options:
				{
					align:"start",
					wrap:"true",
				},
				_widgetClass:"ibx-property-sheet",
				_create:function()
				{
					this._super();
					var header = this._heading = $("<div class='ibx-prop-heading'>").ibxHBox();
					var nameLabel = this._nameLabel = $("<div class='ibx-prop-heading-label ibx-prop-heading-name'>Name</div>").ibxLabel();
					var splitter = this._splitter = $("<div class='ibx-prop-splitter'>").ibxSplitter().on("ibx_resize", this._onSplitterResize.bind(this));
					var valueLabel = this._valueLabel = $("<div class='ibx-prop-heading-label ibx-prop-heading-value'>Value</div>").ibxLabel();
					header.append(nameLabel, splitter, valueLabel);

					var tree = this._propTree = $("<div class='ibx-prop-tree'>").ibxTree();
					var vals = this._propVals = $("<div class='ibx-prop-values'>").ibxVBox();
					this.element.append(header, tree, vals);
				},
				_init:function()
				{
					this._super();
				},
				_destroy:function()
				{
					this._super();
				},
				props:function(props)
				{
					this._props = props;
					this._propTree.ibxWidget("remove");
					this._propVals.ibxWidget("remove");
					this._buildTree(props, this._propTree);
				},
				_buildTree:function(prop, parent)
				{
					for(var key in prop)
					{
						var item = prop[key];
						var treeItem = $("<div class='ibx-prop-tree-node'>").ibxTreeNode({container:!!item.props, labelOptions:{text:item.displayName}});
						treeItem.data("ibxPropInfo", "prop");
						parent.ibxWidget("add", treeItem);
						if(item.props)
						{
							this._buildTree(item.props, treeItem)
						}
					}
				},
				_onSplitterResize:function(e, resizeInfo)
				{
					var width = resizeInfo.el1.outerWidth();
					this._propTree.width(width);
				},
				_refresh:function()
				{
					var options = this.options;
					this._super();
				}
			});
			//# sourceURL=test_res_bundle.xml
		]]>
		</script-block>
	</scripts>
</ibx-res-bundle>