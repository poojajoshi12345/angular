<!DOCTYPE html>
<html lang="en">
	<head>
		<title>HTML Test File</title>
		<meta http-equiv="X-UA-Compatible" content="IE=11">
		<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
		<meta http-equiv="Pragma" content="no-cache" />
		<meta http-equiv="Expires" content="0" />
		<meta name="google" value="notranslate">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script type="text/javascript" src="../../resources/ibx.js"></script>
		<script type="text/javascript">
			ibx(function(e)
			{
				callDone = false;
				$(".test-button").on("click", function(e)
				{
					window.setTimeout(function()
					{
						if(callDone)
						{
							callDone = false;
							return;
						}

						var waiting = ibx.waitStart();
						waiting.on("ibx_waiting", function(e)
						{
							var waiting = $(e.target);
							var btn = waiting.data("btnAbort");
							var startDate = waiting.ibxWidget("startDate");
							var curDate = new Date();
							if(!btn && ((curDate - startDate) > 1000))
							{
								btn = $("<div class='abort-button'>Abort This Action...</div>").ibxButtonSimple();
								btn.on("click", function(waiting, e)
								{
									ibx.waitStop();
									callDone = false;
								}.bind(this, waiting));

								waiting.ibxWidget("add", btn);
								waiting.data("btnAbort", btn);
							}
						});
					}, 0);

					$(".test-stop").on("click", function(e)
					{
						callDone = true;
					});
				})
			},true);
		</script>
		<style type="text/css">
			xbody
			{
				margin:0px;
				position:absolute;
				width:100%;
				height:100%;
				box-sizing:border-box;
			}
			.abort-button
			{
				margin:5px;
				padding:5px;
				font-size:2em;
				border:2px solid red;
				border-radius:.25em;
			}
			.test-area
			{
				position:absolute;
				left:100px;
				top:100px;
				width:200px;
				height:200px;
				border:2px solid red;
			}
		</style>
	</head>
	<body class="ibx-root">
		<div class="test-button" data-ibx-type="ibxButton">Start</div>
		<div class="test-stop" data-ibx-type="ibxButton">No Wait (within 750ms)</div>
		<div class="test-area">
		</div>
	</body>
</html>


