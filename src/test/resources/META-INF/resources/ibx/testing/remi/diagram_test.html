<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Diagram Test</title>
		<meta http-equiv="X-UA-Compatible" content="IE=11">
		<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
		<meta http-equiv="Pragma" content="no-cache" />
		<meta http-equiv="Expires" content="0" />
		<meta name="google" value="notranslate">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script type="text/javascript" src="../../resources/ibx.js"></script>
		<script type="text/javascript">
			ibx(function(e) {

				var canvas = $('.test-canvas').ibxDiagram('instance');
				var offset = 250, count = 3;

				$('.btnAddNode').on('click', function(e) {
					canvas.addNode({
						left: offset, top: offset, width: 100, height: 100,
						className: 'layout-item', text: 'Item ' + (count++)
					})
					offset += 120;
				});

				$('.btnGrid').on('ibx_change', function(e) {
					var checked = $(e.target).ibxWidget('checked');
					var grid = checked ? {size: 150, offset: {left: 25, top: 25}} : {size: null, offset: {left: 0, top: 0}};
					$('.test-canvas').ibxWidget('option', 'grid', grid, true);
				});

				var n1 = canvas.addNode({
					left: 20, top: 170, width: 100, height: 100,
					className: 'layout-item', text: 'Item 1',
					anchors: {
						right: {className: 'anchor', width: 15, height: 15}
					}
				});

				var n2 = canvas.addNode({
					left: 220, top: 20, width: 100, height: 100,
					className: 'layout-item', text: 'Item 2',
					anchors: {
						left: {className: 'anchorSymbol fa fa-adjust', width: 20, height: 20},
						right: {className: 'anchorSymbol fa fa-times-circle', width: 20, height: 20}
					}
				});

				canvas.addConnection({
					from: {node: 0, anchor: 'left'},
					to: {node: n2, anchor: 'right'}
				});

				canvas.addConnection({
					from: {node: n1, anchor: 'left'},
					to: {node: n2, anchor: 'right'}
				});

				canvas.addNode($('<div style="left: 20px; top: 400px; width: 50px; height: 50px" class="layout-item">'));

			}, [{"src" : "./diagram_res_bundle.xml", "loadContext" : "app"}], true);
		</script>
		<style type="text/css">
			html, body {
				width: 100%;
				height: 100%;
				margin: 0px;
				padding: 10px;
				box-sizing: border-box;
			}
			.test-canvas {
				width: 800px;
				height: 700px;
				border: 1px solid black;
			}
			.layout-item {
				width: 75px;
				height: 75px;
				background-color: #eee;
				border: 1px solid black;
			}
			.item-1 {
			}
			.item-2 {
				right: 10px;
				top: 10px;
				width: 100px;
				height: 100px;
			}
			.test-connection {
				border: 1px solid red;
			}

			.anchor {
				background-color: white;
				border: 1px solid black;
				border-radius: 10px;
			}

			.anchorSymbol {
				background-color: white;
				border-radius: 20px;
				font-size: 20px;
				color: #444
			}

			.anchor-right {
				position: absolute;
				left: 95px;
				top: 45px;
				width: 10px;
				height: 10px;
			}

			.btnAddNode {
				margin: 10px;
			}
		</style>
	</head>
	<body class="ibx-root">
		<div class="buttons">
			<div class="btnAddNode" data-ibx-type="ibxButton">Add Node</div>
			<div class="btnGrid" data-ibx-type="ibxCheckBoxSimple">Lock to Grid</div>
		</div>
		<!-- <div class="test-canvas" data-ibx-type="ibxDiagram" data-ibx-options="{grid: {size: 150, offset: {left: 25, top: 25}}}"> -->
		<div class="test-canvas" data-ibx-type="ibxDiagram">
			<div
				class="layout-item item-1"
				data-ibx-type="ibxDiagramNode"
				data-ibx-options="{left: 20, top: 20, width: 100, height: 100}"
			>
				Layout Item 1
				<div
					class="anchor-right anchor"
				>
				</div>
			</div>
			<div
				class="layout-item item-2"
				data-ibx-type="ibxDiagramNode"
			>
				Layout Item 2
			</div>
		</div>
	</body>
</html>
